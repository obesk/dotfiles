---
- name: install stow
  become: true
  apt:
    name:
      - stow
    state: present


#TODO: use the stow library https://github.com/caian-org/ansible-stow

- name: "stow all configs" 
  dandyrow.linux.stow.stow:
    src: . 
    dest: "{{ ansible_env.HOME }}"
    package: [ kitty, lazygit, nvim, src, tmux, venv, wallpapers, zathura, bash]
    force: true

# - name: unstow all
#   shell: "stow -D . --target {{ ansible_env.HOME }}"
#   changed_when: false
#
# - name: stow all
#   shell: "stow . --target {{ ansible_env.HOME }} --verbose=2"
#   register: result
#   changed_when: 'result.stderr is search("LINK: ")'
